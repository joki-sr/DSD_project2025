# Filter 包说明文档

Filter 包包含系统的所有过滤器，用于请求预处理和响应后处理。在 Spring Security 框架下，过滤器负责拦截请求、验证令牌并设置安全上下文。

## JwtAuthFilter

JWT 认证过滤器，拦截所有请求，验证 JWT 令牌并设置安全上下文。这是系统使用的主要 JWT 过滤器。

### 主要功能

- 拦截所有 HTTP 请求
- 从请求头中提取 Authorization Bearer 令牌
- 验证令牌有效性
- 从令牌中提取用户信息和角色
- 创建认证对象并更新安全上下文
- 允许请求继续处理

### 实现流程

1. 过滤器从请求头中获取 Authorization 字段
2. 检查请求头是否包含 Bearer 令牌
3. 提取令牌并解析用户名
4. 检查用户名和当前安全上下文
5. 使用 UserDetailsService 加载用户详情
6. 验证令牌有效性
7. 获取令牌中的角色
8. 创建认证对象，使用从令牌中提取的角色
9. 设置认证详情
10. 更新安全上下文
11. 继续过滤链处理

## JwtAuthenticationFilter

JWT 认证过滤器的备用实现，实现 OncePerRequestFilter 接口，确保每个请求只执行一次过滤逻辑。

### 主要功能

- 拦截 HTTP 请求
- 从请求头中提取 JWT 令牌
- 验证令牌并从中提取用户信息
- 将用户信息添加到安全上下文中
- 允许认证用户访问受保护资源

### 实现流程

1. 从请求头提取 Authorization 字段
2. 检查是否存在并以"Bearer "开头
3. 提取令牌内容
4. 验证令牌并提取用户名
5. 加载用户详情
6. 创建认证对象
7. 设置安全上下文
8. 继续请求处理
